# ç­çº§ç§¯åˆ†ç®¡ç†ç³»ç»Ÿ (Class Point System)

åŸºäº Cloudflare Workers + D1 æ•°æ®åº“æ„å»ºçš„é«˜æ•ˆã€è½»é‡çº§ç­çº§ç§¯åˆ†ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒ Web ç«¯åŠ Android ç§»åŠ¨ç«¯ã€‚

## ğŸŒŸ åŠŸèƒ½ç‰¹æ€§

- **å¤šç«¯æ”¯æŒ**: å“åº”å¼ Web ç®¡ç†åå° + Android åŸç”Ÿç§»åŠ¨åº”ç”¨ã€‚
- **å…¨æ–¹ä½ç®¡ç†**: å­¦ç”Ÿã€å°ç»„ã€ç§¯åˆ†ç±»åˆ«çš„ä¸€ç«™å¼ç®¡ç†ã€‚
- **å®æ—¶æ’è¡Œæ¦œ**: ä¸ªäººåŠå°ç»„ç§¯åˆ†å®æ—¶ç»Ÿè®¡ä¸æ’åã€‚
- **åŠ¨æ€ç§¯åˆ†**: æ”¯æŒæ‰¹é‡å¯¼å…¥ã€å¤šç»´åº¦åŠ æ‰£åˆ†åŠå†å²è®°å½•æŸ¥è¯¢ã€‚
- **æ•°æ®å¯è§†åŒ–**: ç§¯åˆ†è¶‹åŠ¿åˆ†æä¸ç»Ÿè®¡å›¾è¡¨ã€‚
- **é«˜æ€§èƒ½**: åˆ©ç”¨ Cloudflare è¾¹ç¼˜è®¡ç®—ä¸ D1 æ•°æ®åº“ï¼Œç¡®ä¿å…¨çƒå¿«é€Ÿè®¿é—®ã€‚

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯/Web ç«¯
- **Runtime**: Cloudflare Workers
- **Database**: Cloudflare D1 (SQLite)
- **Framework**: Hono (Web æ¡†æ¶)
- **Template**: Nunjucks (æœåŠ¡ç«¯æ¸²æŸ“)
- **Language**: TypeScript

### ç§»åŠ¨ç«¯ (Android)
- **Language**: Kotlin / Java
- **Build Tool**: Gradle
- **API**: RESTful API (/api/v1)

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†ä¸å®‰è£…
```bash
git clone <repository-url>
cd class_points_system_cloudflare
npm install
```

### 2. åˆå§‹åŒ–æ•°æ®åº“
é¡¹ç›®æ¨èä½¿ç”¨ `class_point_d1.sql` å¿«é€Ÿæ„å»ºå¼€å‘ç¯å¢ƒï¼š
```bash
npm run db:test
```
*è¯¥æ“ä½œä¼šåˆ›å»ºä¸€ä¸ªåŒ…å« 50 åå­¦ç”Ÿã€8 ä¸ªå°ç»„åŠ 800+ æ¡æ¨¡æ‹Ÿè®°å½•çš„æµ‹è¯•åº“ã€‚*

### 3. æœ¬åœ°é¢„è§ˆ
```bash
npm run dev
```
è®¿é—® `http://127.0.0.1:8787`ã€‚

## ğŸ“‚ é¡¹ç›®ç»“æ„

```text
.
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts              # Worker ä¸»å…¥å£
â”‚   â”œâ”€â”€ routes/               # ä¸šåŠ¡è·¯ç”± (web & api)
â”‚   â”‚   â””â”€â”€ api.ts            # å®‰å“ä¸“ç”¨ API æ¥å£
â”‚   â”œâ”€â”€ views/                # è§†å›¾æ¸²æŸ“é€»è¾‘
â”‚   â”œâ”€â”€ lib/                  # æ ¸å¿ƒå·¥å…·ç±»åº“ (db, types, queries)
â”‚   â””â”€â”€ templates.generated.ts # è‡ªåŠ¨ç”Ÿæˆçš„æ¨¡æ¿æ–‡ä»¶
â”œâ”€â”€ templates/               # HTML æ¨¡æ¿æºç 
â”œâ”€â”€ android_app/             # Android åŸç”Ÿåº”ç”¨æºç 
â”œâ”€â”€ migrations/              # D1 æ•°æ®åº“è¿ç§»è„šæœ¬
â”œâ”€â”€ scripts/                 # è‡ªåŠ¨åŒ–è„šæœ¬ (æ¨¡æ¿ç”Ÿæˆã€æ•°æ®è½¬æ¢)
â”œâ”€â”€ class_point_d1.sql      # æ ‡å‡†æµ‹è¯•æ•°æ®é›†
â””â”€â”€ wrangler.toml           # Cloudflare Worker é…ç½®
```

## ğŸ“± ç§»åŠ¨ç«¯é›†æˆ

å®‰å“ç«¯é€šè¿‡ `/api/v1/` è·¯å¾„è®¿é—®æ•°æ®ã€‚ä¸»è¦æ¥å£åŒ…æ‹¬ï¼š
- `GET /api/v1/students`: è·å–å­¦ç”Ÿç»Ÿè®¡ä¿¡æ¯ã€‚
- `GET /api/v1/groups`: è·å–å°ç»„åˆ†å¸ƒåŠç§¯åˆ†ã€‚
- `POST /api/v1/points/add`: æäº¤æ–°çš„ç§¯åˆ†è®°å½•ã€‚

å®‰å“æºç ä½äº `android_app/` ç›®å½•ï¼Œå¯ä½¿ç”¨ Android Studio æ‰“å¼€ã€‚

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### ä¿®æ”¹ç•Œé¢ (Web)
1. ç¼–è¾‘ `templates/` ä¸­çš„ HTML æ–‡ä»¶ã€‚
2. **å¿…é¡»è¿è¡Œ**æ¨¡æ¿ç”Ÿæˆè„šæœ¬: `node scripts/generate_templates.cjs`ã€‚
3. åˆ·æ–°é¡µé¢æˆ–é‡å¯ `npm run dev`ã€‚

### æ•°æ®åº“ç»´æŠ¤
- **åº”ç”¨è¿ç§»**: `npm run db:migrate`
- **é‡ç½®æ•°æ®**: `npm run db:reset`
- **å¯¼å‡ºçº¿ä¸Šæ•°æ®**: `wrangler d1 export class_points_d1 --remote --output=backup.sql`

## âš ï¸ å¸¸è§é—®é¢˜
- **å®‰å“ Gradle é”™è¯¯**: è‹¥é‡åˆ° `DependencyHandler.module` ç›¸å…³æŠ¥é”™ï¼Œè¯·å‚è€ƒ `AGENTS.md` ä¸­çš„ Gradle ç‰ˆæœ¬å›é€€æ–¹æ¡ˆã€‚
- **ç•Œé¢æœªæ›´æ–°**: ç¡®è®¤æ˜¯å¦æ‰§è¡Œäº† `generate_templates.cjs` è„šæœ¬ã€‚

## ğŸ“„ è®¸å¯è¯
MIT License
